<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>sigmaboiprozzzzyzyzyz Proxy</title>
</head>
<body>
  <h1>sigmaboiprozzzzyzyzyz Proxy</h1>
  <form id="proxyForm">
    <input type="text" id="urlInput" placeholder="Type a URL or search term">
    <button type="submit">Go</button>
  </form>
  <iframe id="proxyFrame" style="width:100%; height:80vh;"></iframe>

  <script>
    const historyStack = [];
    let historyIndex = -1;
    const frame = document.getElementById('proxyFrame');

    function isFullUrl(text) {
      return /^https?:\/\//i.test(text);
    }
    function looksLikeDomain(text) {
      return /^[\w.-]+\.[a-z]{2,}(?:\/.*)?$/i.test(text);
    }
    function toUrlOrSearch(input) {
      if (!input) return 'https://www.google.com/';
      if (isFullUrl(input)) return input;
      if (looksLikeDomain(input)) return 'https://' + input;
      return 'https://www.google.com/search?q=' + encodeURIComponent(input);
    }
    function load(url, push = true) {
      const target = toUrlOrSearch(url);
      frame.src = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(target);
      if (push) {
        historyStack.splice(historyIndex + 1);
        historyStack.push(url);
        historyIndex = historyStack.length - 1;
      }
    }

    document.getElementById('proxyForm').addEventListener('submit', function(e) {
      e.preventDefault();
      load(document.getElementById('urlInput').value.trim());
    });

    window.addEventListener('message', (e) => {
      if (e.data.type === 'navigate' && e.data.url) {
        load(e.data.url, true);
      }
    });

    // Initial load
    load('');
  </script>
</body>
</html>
